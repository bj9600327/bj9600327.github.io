<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>《python网络爬虫权威指南》读书笔记 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="前言ch01 初见网络爬虫ch06 存储数据ch0 ch11 抓取-JavaScript15.3 Selenium 单元测试 前言建议所有读者学习第一部分，并根据自己的实际需求深入探索第二部分按初、中级Python编程水平来编写书中的概念和代码示例 大体上，你遇到的90%的网页爬取项目使用的都是前6章介绍的技术ch01 初见网络爬虫本章将首先向网络服务器发送GET请求。只有三行代码的scrapet">
<meta property="og:type" content="article">
<meta property="og:title" content="《python网络爬虫权威指南》读书笔记">
<meta property="og:url" content="http://example.com/2021/05/05/web-scraping-with-python/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="前言ch01 初见网络爬虫ch06 存储数据ch0 ch11 抓取-JavaScript15.3 Selenium 单元测试 前言建议所有读者学习第一部分，并根据自己的实际需求深入探索第二部分按初、中级Python编程水平来编写书中的概念和代码示例 大体上，你遇到的90%的网页爬取项目使用的都是前6章介绍的技术ch01 初见网络爬虫本章将首先向网络服务器发送GET请求。只有三行代码的scrapet">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-05-05T09:27:47.000Z">
<meta property="article:modified_time" content="2022-05-11T03:19:10.222Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-web-scraping-with-python" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/05/05/web-scraping-with-python/" class="article-date">
  <time class="dt-published" datetime="2021-05-05T09:27:47.000Z" itemprop="datePublished">2021-05-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/book-note/">book-note</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      《python网络爬虫权威指南》读书笔记
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a href="#%E5%89%8D%E8%A8%80">前言</a><br><a href="#ch01-%E5%88%9D%E8%A7%81%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB">ch01 初见网络爬虫</a><br><a href="#ch06-%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE">ch06 存储数据</a><br><a href="#ch0">ch0 </a><br><a href="#ch11-%E6%8A%93%E5%8F%96-JavaScript">ch11 抓取-JavaScript</a><br><a href="#15-3-Selenium-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95">15.3 Selenium 单元测试</a></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="建议所有读者学习第一部分，并根据自己的实际需求深入探索第二部分"><a href="#建议所有读者学习第一部分，并根据自己的实际需求深入探索第二部分" class="headerlink" title="建议所有读者学习第一部分，并根据自己的实际需求深入探索第二部分"></a>建议所有读者学习第一部分，并根据自己的实际需求深入探索第二部分</h2><p>按初、中级Python编程水平来编写书中的概念和代码示例</p>
<h2 id="大体上，你遇到的90-的网页爬取项目使用的都是前6章介绍的技术"><a href="#大体上，你遇到的90-的网页爬取项目使用的都是前6章介绍的技术" class="headerlink" title="大体上，你遇到的90%的网页爬取项目使用的都是前6章介绍的技术"></a>大体上，你遇到的90%的网页爬取项目使用的都是前6章介绍的技术</h2><h1 id="ch01-初见网络爬虫"><a href="#ch01-初见网络爬虫" class="headerlink" title="ch01 初见网络爬虫"></a>ch01 初见网络爬虫</h1><h2 id="本章将首先向网络服务器发送GET请求。只有三行代码的scrapetest-py即可实现。"><a href="#本章将首先向网络服务器发送GET请求。只有三行代码的scrapetest-py即可实现。" class="headerlink" title="本章将首先向网络服务器发送GET请求。只有三行代码的scrapetest.py即可实现。"></a>本章将首先向网络服务器发送GET请求。只有三行代码的scrapetest.py即可实现。</h2><h3 id="1-1-网络连接"><a href="#1-1-网络连接" class="headerlink" title="1.1 网络连接"></a>1.1 网络连接</h3><p>当Web浏览器遇到一个标签时，比如<code>&lt;img src=&quot;cuteKitten.jpg&gt;</code>，会向服务器发起另一个请求以获取图片文件。你的Python程序没有请求多个文件的逻辑，它只能读取你直接请求的单个HTML文件。</p>
<h3 id="1-2-BeautifulSoup简介"><a href="#1-2-BeautifulSoup简介" class="headerlink" title="1.2 BeautifulSoup简介"></a>1.2 BeautifulSoup简介</h3><h4 id="1-2-1-安装BeautifulSoup"><a href="#1-2-1-安装BeautifulSoup" class="headerlink" title="1.2.1 安装BeautifulSoup"></a>1.2.1 安装BeautifulSoup</h4><h4 id="1-2-2-运行BeautifulSoup"><a href="#1-2-2-运行BeautifulSoup" class="headerlink" title="1.2.2 运行BeautifulSoup"></a>1.2.2 运行BeautifulSoup</h4><p><code>bs = BeautifulSoup(html.read(), &#39;html.parser&#39;) </code>第二个参数指定了解析器，在大多数情况下，你选择任何一个解析器都差别不大。</p>
<p><code>print(bs.h1)</code>仅仅显示了页面上的<strong>第一个</strong> h1 标签。</p>
<h4 id="1-2-3-可靠的网络连接以及异常的处理"><a href="#1-2-3-可靠的网络连接以及异常的处理" class="headerlink" title="1.2.3 可靠的网络连接以及异常的处理"></a>1.2.3 可靠的网络连接以及异常的处理</h4><p>函数urlopen主要会发生两种异常</p>
<ul>
<li>网页在服务器上不存在（或者获取页面的时候出现错误）：会抛出HTTPError异常</li>
<li>服务器不存在：会抛出URLError异常</li>
</ul>
<p>即使从服务器成功获取网页，网页上的内容可能并非完全是我们期望的那样。</p>
<ul>
<li>如果你想要调用的标签不存在，BeautifulSoup就会返回None对象。</li>
<li>如果再调用这个None对象下面的子标签，就会发生AttributeError错误</li>
</ul>
<h1 id="ch06-存储数据"><a href="#ch06-存储数据" class="headerlink" title="ch06 存储数据"></a>ch06 存储数据</h1><p>3种数据管理方法：写入数据库、存到硬盘、发邮件</p>
<h2 id="这一章的内容其实是实现第二部分许多示例的基础"><a href="#这一章的内容其实是实现第二部分许多示例的基础" class="headerlink" title="这一章的内容其实是实现第二部分许多示例的基础"></a>这一章的内容其实是实现第二部分许多示例的基础</h2><h3 id="6-1-媒体文件"><a href="#6-1-媒体文件" class="headerlink" title="6.1 媒体文件"></a>6.1 媒体文件</h3><p>用<code>urllib.request.urlretrieve</code>下载图片</p>
<h3 id="6-2-把数据存储到CSV"><a href="#6-2-把数据存储到CSV" class="headerlink" title="6.2 把数据存储到CSV"></a>6.2 把数据存储到CSV</h3><p>Python的CSV库可以非常简单地修改CSV文件</p>
<h2 id="本章剩余内容跳过"><a href="#本章剩余内容跳过" class="headerlink" title="本章剩余内容跳过"></a>本章剩余内容跳过</h2><h1 id="ch11-抓取-JavaScript"><a href="#ch11-抓取-JavaScript" class="headerlink" title="ch11 抓取 JavaScript"></a>ch11 抓取 JavaScript</h1><p>两种客户端脚本语言</p>
<ul>
<li>ActionScript：开发Flash应用的语言，需求并不多</li>
<li>JavaScript：它可以手机用户跟踪数据，不需要重载页面直接提交表单，在页面中嵌入多媒体文件，甚至运行在线游戏。你可以在网页源代码的<code>&lt;script&gt;</code>标签之间看到它们。</li>
</ul>
<h3 id="11-1-JavaScript简介"><a href="#11-1-JavaScript简介" class="headerlink" title="11.1 JavaScript简介"></a>11.1 JavaScript简介</h3><h4 id="了解语法"><a href="#了解语法" class="headerlink" title="了解语法"></a>了解语法</h4><h4 id="常用JavaScript库"><a href="#常用JavaScript库" class="headerlink" title="常用JavaScript库"></a>常用JavaScript库</h4><ol>
<li>jQuery</li>
<li>Google Analytics</li>
<li>Google Map</li>
</ol>
<h3 id="11-2-Ajax和动态HTML"><a href="#11-2-Ajax和动态HTML" class="headerlink" title="11.2 Ajax和动态HTML"></a>11.2 Ajax和动态HTML</h3><p>如果提交表单之后，网站的页面不需要重新加载，那么你访问的网站很可能使用了Ajax技术。</p>
<p>两种途径：</p>
<ul>
<li>直接从JavaScript代码里抓取内容</li>
<li>用Python的第三方库执行JavaScript，直接抓取你在浏览器里看到的页面</li>
</ul>
<h4 id="11-2-1-Selenium"><a href="#11-2-1-Selenium" class="headerlink" title="11.2.1 Selenium"></a>11.2.1 Selenium</h4><p>页面的加载时间时不确定的。高效的方法是，让Selenium不断地检查某个元素是否存在，以次确定页面是否已经完全加载。</p>
<p>Selenium的选择器<code>find_element_by_css_selector(&#39;#content&#39;)</code>也可以用复数<code>find_elements_by_css_selector(&#39;#content&#39;)</code>来返回一个Python列表</p>
<p>想用BeautifulSoup来解析网页内容，可以用driver.page_source返回页面的源代码字符串</p>
<p>隐式等待时等DOM中某个状态发生后再继续运行代码。可捕获TimeoutException</p>
<p>触发的期望条件有4种。大多数期望条件在使用前都需要你先指定等待的目标元素。元素用定位器指定。定位器与选择器是不一样的。定位器是一种抽象的查询语言，用By对象表示，可以用于不同的场合，包括创建选择器。By的策略包括：</p>
<ul>
<li>IF</li>
<li>CLASS_NAME</li>
<li>CSS_SELECTOR</li>
<li>LINK_TEXT：通过链接文字查找<code>&lt;a&gt;</code>标签</li>
<li>PARTIAL_LINK_TEXT：只通过部分链接文字查找</li>
<li>NAME</li>
<li>TAG_NAME</li>
<li>XPATH</li>
</ul>
<h4 id="11-2-2-webdriver-Firefox"><a href="#11-2-2-webdriver-Firefox" class="headerlink" title="11.2.2 webdriver.Firefox"></a>11.2.2 webdriver.Firefox</h4><h3 id="11-3-处理重定向"><a href="#11-3-处理重定向" class="headerlink" title="11.3 处理重定向"></a>11.3 处理重定向</h3><ul>
<li>服务器端重定向可以轻松地通过urllib库解决</li>
<li>客户端重定向的主要问题是什么时候停止页面执行。</li>
</ul>
<p>检测客户端重定向是否已完成的智能方法：从页面开始加载时就监视DOM中的一个元素，然后重复调用这个元素，直到抛出StaleElementReferenceException异常。</p>
<p>等待元素的出现和消失是Selenium中一个常见的任务</p>
<h3 id="11-4-如果你仍然难以应对某种复杂的JavaScript情形，可以到第15章查找关于Selenium以及直接与动态网站交互的信息。"><a href="#11-4-如果你仍然难以应对某种复杂的JavaScript情形，可以到第15章查找关于Selenium以及直接与动态网站交互的信息。" class="headerlink" title="11.4 如果你仍然难以应对某种复杂的JavaScript情形，可以到第15章查找关于Selenium以及直接与动态网站交互的信息。"></a>11.4 如果你仍然难以应对某种复杂的JavaScript情形，可以到第15章查找关于Selenium以及直接与动态网站交互的信息。</h3><h1 id="ch14-避开抓取陷阱"><a href="#ch14-避开抓取陷阱" class="headerlink" title="ch14 避开抓取陷阱"></a>ch14 避开抓取陷阱</h1><h3 id="14-2-让网络机器人看着像人类用户"><a href="#14-2-让网络机器人看着像人类用户" class="headerlink" title="14.2 让网络机器人看着像人类用户"></a>14.2 让网络机器人看着像人类用户</h3><h4 id="14-2-1-修改请求头"><a href="#14-2-1-修改请求头" class="headerlink" title="14.2.1 修改请求头"></a>14.2.1 修改请求头</h4><p>参考ch10</p>
<p>经典的Python爬虫在使用urllib时，都会发送如下的请求头<code>User-Agent=Python-urllib/3.4</code></p>
<h4 id="14-2-2-用JavaScript处理cookie"><a href="#14-2-2-用JavaScript处理cookie" class="headerlink" title="14.2.2 用JavaScript处理cookie"></a>14.2.2 用JavaScript处理cookie</h4><h4 id="14-2-3-时间就是一切"><a href="#14-2-3-时间就是一切" class="headerlink" title="14.2.3 时间就是一切"></a>14.2.3 时间就是一切</h4><h3 id="14-3-常见表单安全措施"><a href="#14-3-常见表单安全措施" class="headerlink" title="14.3 常见表单安全措施"></a>14.3 常见表单安全措施</h3><h3 id="14-4-问题检查表"><a href="#14-4-问题检查表" class="headerlink" title="14.4 问题检查表"></a>14.4 问题检查表</h3><ul>
<li>如果收到的页面是空白的或与浏览器上看到的不一样，有可能是因为JavaScript执行有问题。</li>
<li>POST请求要检查字段和格式是否正确</li>
<li>无法保持登录状态，请检查你的cookie</li>
<li>遇到HTTP错误，尤其是403禁止访问错误，这可能说明网站已经把你的IP地址当做机器人了。你要么等待，要么换个IP地址（可以去星巴克上网，或者看看第17章的内容）。为了确保不会再次被封杀，请做到以下几点：<ul>
<li>给爬虫增加延迟，让它们在夜深人静的时候运行</li>
<li>修改请求头</li>
<li>确认你没有点击或访问任何人类用户通常不能点击或访问的信息</li>
<li>联系网管</li>
</ul>
</li>
</ul>
<h3 id="15-3-Selenium-单元测试"><a href="#15-3-Selenium-单元测试" class="headerlink" title="15.3 Selenium 单元测试"></a>15.3 Selenium 单元测试</h3><p>Selenium可以对任何给定元素执行很多操作：click,click_and_hold,release,double_click,send_keys_to_element</p>
<p>除了一次性完成一个元素的多个操作，还可以将一组操作组合成一个动作链</p>
<h4 id="拖放与截屏"><a href="#拖放与截屏" class="headerlink" title="拖放与截屏"></a>拖放与截屏</h4>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/05/web-scraping-with-python/" data-id="cl310rf3v0014gctk1kpl02tk" data-title="《python网络爬虫权威指南》读书笔记" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/05/09/tcp-ip-xiang-jie/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          《TCP/IP详解》读书笔记
        
      </div>
    </a>
  
  
    <a href="/2021/04/29/jing-tong-git/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">《精通git》读书笔记</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/bao-xian/">bao-xian</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/book-note/">book-note</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/health/">health</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/humor/">humor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jekyll-update/">jekyll update</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1021/04/">April 1021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/08/10/high-availability-linux/">《构建高可用Linux服务器》读书笔记</a>
          </li>
        
          <li>
            <a href="/2021/07/21/mysql-ji-shu-nei-mu/">《mysql技术内幕》读书笔记</a>
          </li>
        
          <li>
            <a href="/2021/07/19/ubuntu-linux-os/">Ubuntu相关读书笔记</a>
          </li>
        
          <li>
            <a href="/2021/07/07/shell-program-demo/">shell例程</a>
          </li>
        
          <li>
            <a href="/2021/07/06/unix-bian-cheng-yi-shu/">《UNIX编程艺术》读书笔记</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>